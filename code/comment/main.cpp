// g++ -frounding-math -ffloat-store -I/usr/local/include -I/usr/local/include/ibex  -O3 -DNDEBUG -Wno-deprecated -frounding-math  -o main main.cpp -L/usr/local/lib -libex -lprim -lClp -lCoinUtils

// g++ -frounding-math -ffloat-store -I/usr/local/include/ibex  -o main main.cpp -libex -lprim -lClp -lCoinUtils

// g++  -I/usr/local/include/ibex  -o main main.cpp -libex -lprim

#include <ibex.h>
#include <vector>
#include <queue>
#include <iostream>
#include <sstream>
#include <cmath>

#include "Processing.h"
#include "LUtils.h"
#include "LMatplotlibcpp.h"

using namespace ibex;
using namespace LSwitchedSystem;

// Matplotlib
// sudo apt-get install python-matplotlib python-numpy python2.7-dev


#define FIND_PATTERN 1 // Then comment again

#define DECOMPOSE 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
// Macro variables to set the values of the maximal length of a
// pattern (NB_K) and the maximal number of splittings of the
// state-space (NB_D)
#define NB_K 3
#define NB_D 20

int main()
{

	cout << "sdsd" << endl

	const int n = 4;
	Variable y(n);

	Interval heat_s(0.0, 1.0);
	Interval V1(3.5);
	Interval V2(3);
	Interval V3(3);
	Interval V4(3.5);
	Interval Tu(17.0);
	Interval To(27.0, 30.0);
	Interval Tc(27.0, 30.0);

	// 0 0 0 0
	Function m01 = Function(y, Return((2.85 * 0.0001) * (y[1] - y[0]) + (2.47 * 0.0001) * (y[3] - y[0]) + (7.36 * 0.00001) * (Tu - y[0]) + (5.78 * 0.0001) * (To - y[0]) + (9.27 * 0.00001) * (Tc - y[0]) + (heat_s * (3.12 * 0.00000000000000001)) * (((3.73 * 1000) * (3.73 * 1000)) * ((3.73 * 1000) * (3.73 * 1000)) - y[0] * (y[0] * (y[0] * y[0]))),
																		(7.60 * 0.00001) * (y[0] - y[1]) + (1.89 * 0.0001) * (y[2] - y[1]) + (7.02 * 0.00001) * (Tu - y[1]) + (6.21 * 0.0001) * (To - y[1]) + (2.42 * 0.0001) * (Tc - y[1]) + (heat_s * (2.55 * 0.0000000000000001)) * (((1.78 * 1000) * (1.78 * 1000)) * ((1.78 * 1000) * (1.78 * 1000)) - (y[1] * y[1]) * (y[1] * y[1])),
																		1.79 * (0.0001 * (y[1] - y[2])) + 3.81 * (0.0001 * (y[3] - y[2])) + (3.45 * 0.00001) * (Tu - y[2]) + (5.64 * 0.0001) * (To - y[2]) + (3.21 * 0.00000001) * (Tc - y[2]) + (heat_s * (8.57 * 0.0000000000001)) * (((3.82 * 100) * (3.82 * 100)) * ((3.82 * 100) * (3.82 * 100)) - (y[2] * y[2]) * (y[2] * y[2])),
																		1.09 * (0.0001 * (y[0] - y[3])) + 1.07 * (0.0001 * (y[2] - y[3])) + (3.26 * 0.00001) * (Tu - y[3]) + (5.99 * 0.0001) * (To - y[3]) + (1.73 * 0.0001) * (Tc - y[3]) + (heat_s * (3.57 * 0.00000000000000001)) * (((3.93 * 1000) * (3.93 * 1000)) * ((3.93 * 1000) * (3.93 * 1000)) - (y[3] * y[3]) * (y[3] * y[3]))));
	// 1 0 0 0
	Function m02 = Function(y, Return((2.85 * 0.0001) * (y[1] - y[0]) + (2.47 * 0.0001) * (y[3] - y[0]) + (7.36 * 0.00001) * (Tu - y[0]) + (5.78 * 0.0001) * (To - y[0]) + (9.27 * 0.00001) * (Tc - y[0]) + (heat_s * (3.12 * 0.00000000000000001)) * (((3.73 * 1000) * (3.73 * 1000)) * ((3.73 * 1000) * (3.73 * 1000)) - y[0] * (y[0] * (y[0] * y[0]))) + ((2.12 * 0.001) * V1) * (Tu - y[0]),
																		(7.60 * 0.00001) * (y[0] - y[1]) + (1.89 * 0.0001) * (y[2] - y[1]) + (7.02 * 0.00001) * (Tu - y[1]) + (6.21 * 0.0001) * (To - y[1]) + (2.42 * 0.0001) * (Tc - y[1]) + (heat_s * (2.55 * 0.0000000000000001)) * (((1.78 * 1000) * (1.78 * 1000)) * ((1.78 * 1000) * (1.78 * 1000)) - (y[1] * y[1]) * (y[1] * y[1])),
																		1.79 * (0.0001 * (y[1] - y[2])) + 3.81 * (0.0001 * (y[3] - y[2])) + (3.45 * 0.00001) * (Tu - y[2]) + (5.64 * 0.0001) * (To - y[2]) + (3.21 * 0.00000001) * (Tc - y[2]) + (heat_s * (8.57 * 0.0000000000001)) * (((3.82 * 100) * (3.82 * 100)) * ((3.82 * 100) * (3.82 * 100)) - (y[2] * y[2]) * (y[2] * y[2])),
																		1.09 * (0.0001 * (y[0] - y[3])) + 1.07 * (0.0001 * (y[2] - y[3])) + (3.26 * 0.00001) * (Tu - y[3]) + (5.99 * 0.0001) * (To - y[3]) + (1.73 * 0.0001) * (Tc - y[3]) + (heat_s * (3.57 * 0.00000000000000001)) * (((3.93 * 1000) * (3.93 * 1000)) * ((3.93 * 1000) * (3.93 * 1000)) - (y[3] * y[3]) * (y[3] * y[3]))));

	// 0 1 0 0
	Function m03 = Function(y, Return((2.85 * 0.0001) * (y[1] - y[0]) + (2.47 * 0.0001) * (y[3] - y[0]) + (7.36 * 0.00001) * (Tu - y[0]) + (5.78 * 0.0001) * (To - y[0]) + (9.27 * 0.00001) * (Tc - y[0]) + (heat_s * (3.12 * 0.00000000000000001)) * (((3.73 * 1000) * (3.73 * 1000)) * ((3.73 * 1000) * (3.73 * 1000)) - y[0] * (y[0] * (y[0] * y[0]))),
																		(7.60 * 0.00001) * (y[0] - y[1]) + (1.89 * 0.0001) * (y[2] - y[1]) + (7.02 * 0.00001) * (Tu - y[1]) + (6.21 * 0.0001) * (To - y[1]) + (2.42 * 0.0001) * (Tc - y[1]) + (heat_s * (2.55 * 0.0000000000000001)) * (((1.78 * 1000) * (1.78 * 1000)) * ((1.78 * 1000) * (1.78 * 1000)) - (y[1] * y[1]) * (y[1] * y[1])) + ((1.83 * 0.001) * V2) * (Tu - y[1]),
																		1.79 * (0.0001 * (y[1] - y[2])) + 3.81 * (0.0001 * (y[3] - y[2])) + (3.45 * 0.00001) * (Tu - y[2]) + (5.64 * 0.0001) * (To - y[2]) + (3.21 * 0.00000001) * (Tc - y[2]) + (heat_s * (8.57 * 0.0000000000001)) * (((3.82 * 100) * (3.82 * 100)) * ((3.82 * 100) * (3.82 * 100)) - (y[2] * y[2]) * (y[2] * y[2])),
																		1.09 * (0.0001 * (y[0] - y[3])) + 1.07 * (0.0001 * (y[2] - y[3])) + (3.26 * 0.00001) * (Tu - y[3]) + (5.99 * 0.0001) * (To - y[3]) + (1.73 * 0.0001) * (Tc - y[3]) + (heat_s * (3.57 * 0.00000000000000001)) * (((3.93 * 1000) * (3.93 * 1000)) * ((3.93 * 1000) * (3.93 * 1000)) - (y[3] * y[3]) * (y[3] * y[3]))));

	// 0 0 1 0
	Function m04 = Function(y, Return((2.85 * 0.0001) * (y[1] - y[0]) + (2.47 * 0.0001) * (y[3] - y[0]) + (7.36 * 0.00001) * (Tu - y[0]) + (5.78 * 0.0001) * (To - y[0]) + (9.27 * 0.00001) * (Tc - y[0]) + (heat_s * (3.12 * 0.00000000000000001)) * (((3.73 * 1000) * (3.73 * 1000)) * ((3.73 * 1000) * (3.73 * 1000)) - y[0] * (y[0] * (y[0] * y[0]))),
																		(7.60 * 0.00001) * (y[0] - y[1]) + (1.89 * 0.0001) * (y[2] - y[1]) + (7.02 * 0.00001) * (Tu - y[1]) + (6.21 * 0.0001) * (To - y[1]) + (2.42 * 0.0001) * (Tc - y[1]) + (heat_s * (2.55 * 0.0000000000000001)) * (((1.78 * 1000) * (1.78 * 1000)) * ((1.78 * 1000) * (1.78 * 1000)) - (y[1] * y[1]) * (y[1] * y[1])),
																		1.79 * (0.0001 * (y[1] - y[2])) + 3.81 * (0.0001 * (y[3] - y[2])) + (3.45 * 0.00001) * (Tu - y[2]) + (5.64 * 0.0001) * (To - y[2]) + (3.21 * 0.00000001) * (Tc - y[2]) + (heat_s * (8.57 * 0.0000000000001)) * (((3.82 * 100) * (3.82 * 100)) * ((3.82 * 100) * (3.82 * 100)) - (y[2] * y[2]) * (y[2] * y[2])) + ((3.05 * 0.001) * V3) * (Tu - y[2]),
																		1.09 * (0.0001 * (y[0] - y[3])) + 1.07 * (0.0001 * (y[2] - y[3])) + (3.26 * 0.00001) * (Tu - y[3]) + (5.99 * 0.0001) * (To - y[3]) + (1.73 * 0.0001) * (Tc - y[3]) + (heat_s * (3.57 * 0.00000000000000001)) * (((3.93 * 1000) * (3.93 * 1000)) * ((3.93 * 1000) * (3.93 * 1000)) - (y[3] * y[3]) * (y[3] * y[3]))));

	// 0 0 0 1
	Function m05 = Function(y, Return((2.85 * 0.0001) * (y[1] - y[0]) + (2.47 * 0.0001) * (y[3] - y[0]) + (7.36 * 0.00001) * (Tu - y[0]) + (5.78 * 0.0001) * (To - y[0]) + (9.27 * 0.00001) * (Tc - y[0]) + (heat_s * (3.12 * 0.00000000000000001)) * (((3.73 * 1000) * (3.73 * 1000)) * ((3.73 * 1000) * (3.73 * 1000)) - y[0] * (y[0] * (y[0] * y[0]))),
																		(7.60 * 0.00001) * (y[0] - y[1]) + (1.89 * 0.0001) * (y[2] - y[1]) + (7.02 * 0.00001) * (Tu - y[1]) + (6.21 * 0.0001) * (To - y[1]) + (2.42 * 0.0001) * (Tc - y[1]) + (heat_s * (2.55 * 0.0000000000000001)) * (((1.78 * 1000) * (1.78 * 1000)) * ((1.78 * 1000) * (1.78 * 1000)) - (y[1] * y[1]) * (y[1] * y[1])),
																		1.79 * (0.0001 * (y[1] - y[2])) + 3.81 * (0.0001 * (y[3] - y[2])) + (3.45 * 0.00001) * (Tu - y[2]) + (5.64 * 0.0001) * (To - y[2]) + (3.21 * 0.00000001) * (Tc - y[2]) + (heat_s * (8.57 * 0.0000000000001)) * (((3.82 * 100) * (3.82 * 100)) * ((3.82 * 100) * (3.82 * 100)) - (y[2] * y[2]) * (y[2] * y[2])),
																		1.09 * (0.0001 * (y[0] - y[3])) + 1.07 * (0.0001 * (y[2] - y[3])) + (3.26 * 0.00001) * (Tu - y[3]) + (5.99 * 0.0001) * (To - y[3]) + (1.73 * 0.0001) * (Tc - y[3]) + (heat_s * (3.57 * 0.00000000000000001)) * (((3.93 * 1000) * (3.93 * 1000)) * ((3.93 * 1000) * (3.93 * 1000)) - (y[3] * y[3]) * (y[3] * y[3])) + ((1.4 * 0.001) * V4) * (Tu - y[3])));

	// 1 1 0 0
	Function m06 = Function(y, Return((2.85 * 0.0001) * (y[1] - y[0]) + (2.47 * 0.0001) * (y[3] - y[0]) + (7.36 * 0.00001) * (Tu - y[0]) + (5.78 * 0.0001) * (To - y[0]) + (9.27 * 0.00001) * (Tc - y[0]) + (heat_s * (3.12 * 0.00000000000000001)) * (((3.73 * 1000) * (3.73 * 1000)) * ((3.73 * 1000) * (3.73 * 1000)) - y[0] * (y[0] * (y[0] * y[0]))) + ((2.12 * 0.001) * V1) * (Tu - y[0]),
																		(7.60 * 0.00001) * (y[0] - y[1]) + (1.89 * 0.0001) * (y[2] - y[1]) + (7.02 * 0.00001) * (Tu - y[1]) + (6.21 * 0.0001) * (To - y[1]) + (2.42 * 0.0001) * (Tc - y[1]) + (heat_s * (2.55 * 0.0000000000000001)) * (((1.78 * 1000) * (1.78 * 1000)) * ((1.78 * 1000) * (1.78 * 1000)) - (y[1] * y[1]) * (y[1] * y[1])) + ((1.83 * 0.001) * V2) * (Tu - y[1]),
																		1.79 * (0.0001 * (y[1] - y[2])) + 3.81 * (0.0001 * (y[3] - y[2])) + (3.45 * 0.00001) * (Tu - y[2]) + (5.64 * 0.0001) * (To - y[2]) + (3.21 * 0.00000001) * (Tc - y[2]) + (heat_s * (8.57 * 0.0000000000001)) * (((3.82 * 100) * (3.82 * 100)) * ((3.82 * 100) * (3.82 * 100)) - (y[2] * y[2]) * (y[2] * y[2])),
																		1.09 * (0.0001 * (y[0] - y[3])) + 1.07 * (0.0001 * (y[2] - y[3])) + (3.26 * 0.00001) * (Tu - y[3]) + (5.99 * 0.0001) * (To - y[3]) + (1.73 * 0.0001) * (Tc - y[3]) + (heat_s * (3.57 * 0.00000000000000001)) * (((3.93 * 1000) * (3.93 * 1000)) * ((3.93 * 1000) * (3.93 * 1000)) - (y[3] * y[3]) * (y[3] * y[3]))));

	// 1 0 1 0
	Function m07 = Function(y, Return((2.85 * 0.0001) * (y[1] - y[0]) + (2.47 * 0.0001) * (y[3] - y[0]) + (7.36 * 0.00001) * (Tu - y[0]) + (5.78 * 0.0001) * (To - y[0]) + (heat_s * (3.12 * 0.00000000000000001)) * (((3.73 * 1000) * (3.73 * 1000)) * ((3.73 * 1000) * (3.73 * 1000)) - y[0] * (y[0] * (y[0] * y[0]))) + ((2.12 * 0.001) * V1) * (Tu - y[0]),
																		(7.60 * 0.00001) * (y[0] - y[1]) + (1.89 * 0.0001) * (y[2] - y[1]) + (7.02 * 0.00001) * (Tu - y[1]) + (6.21 * 0.0001) * (To - y[1]) + (2.42 * 0.0001) * (Tc - y[1]) + (heat_s * (2.55 * 0.0000000000000001)) * (((1.78 * 1000) * (1.78 * 1000)) * ((1.78 * 1000) * (1.78 * 1000)) - (y[1] * y[1]) * (y[1] * y[1])),
																		1.79 * (0.0001 * (y[1] - y[2])) + 3.81 * (0.0001 * (y[3] - y[2])) + (3.45 * 0.00001) * (Tu - y[2]) + (5.64 * 0.0001) * (To - y[2]) + (3.21 * 0.00000001) * (Tc - y[2]) + (heat_s * (8.57 * 0.0000000000001)) * (((3.82 * 100) * (3.82 * 100)) * ((3.82 * 100) * (3.82 * 100)) - (y[2] * y[2]) * (y[2] * y[2])) + ((3.05 * 0.001) * V3) * (Tu - y[2]),
																		1.09 * (0.0001 * (y[0] - y[3])) + 1.07 * (0.0001 * (y[2] - y[3])) + (3.26 * 0.00001) * (Tu - y[3]) + (5.99 * 0.0001) * (To - y[3]) + (1.73 * 0.0001) * (Tc - y[3]) + (heat_s * (3.57 * 0.00000000000000001)) * (((3.93 * 1000) * (3.93 * 1000)) * ((3.93 * 1000) * (3.93 * 1000)) - (y[3] * y[3]) * (y[3] * y[3]))));

	// 1 0 0 1
	Function m08 = Function(y, Return((2.85 * 0.0001) * (y[1] - y[0]) + (2.47 * 0.0001) * (y[3] - y[0]) + (7.36 * 0.00001) * (Tu - y[0]) + (5.78 * 0.0001) * (To - y[0]) + (9.27 * 0.00001) * (Tc - y[0]) + (heat_s * (3.12 * 0.00000000000000001)) * (((3.73 * 1000) * (3.73 * 1000)) * ((3.73 * 1000) * (3.73 * 1000)) - y[0] * (y[0] * (y[0] * y[0]))) + ((2.12 * 0.001) * V1) * (Tu - y[0]),
																		(7.60 * 0.00001) * (y[0] - y[1]) + (1.89 * 0.0001) * (y[2] - y[1]) + (7.02 * 0.00001) * (Tu - y[1]) + (6.21 * 0.0001) * (To - y[1]) + (2.42 * 0.0001) * (Tc - y[1]) + (heat_s * (2.55 * 0.0000000000000001)) * (((1.78 * 1000) * (1.78 * 1000)) * ((1.78 * 1000) * (1.78 * 1000)) - (y[1] * y[1]) * (y[1] * y[1])),
																		1.79 * (0.0001 * (y[1] - y[2])) + 3.81 * (0.0001 * (y[3] - y[2])) + (3.45 * 0.00001) * (Tu - y[2]) + (5.64 * 0.0001) * (To - y[2]) + (3.21 * 0.00000001) * (Tc - y[2]) + (heat_s * (8.57 * 0.0000000000001)) * (((3.82 * 100) * (3.82 * 100)) * ((3.82 * 100) * (3.82 * 100)) - (y[2] * y[2]) * (y[2] * y[2])),
																		1.09 * (0.0001 * (y[0] - y[3])) + 1.07 * (0.0001 * (y[2] - y[3])) + (3.26 * 0.00001) * (Tu - y[3]) + (5.99 * 0.0001) * (To - y[3]) + (1.73 * 0.0001) * (Tc - y[3]) + (heat_s * (3.57 * 0.00000000000000001)) * (((3.93 * 1000) * (3.93 * 1000)) * ((3.93 * 1000) * (3.93 * 1000)) - (y[3] * y[3]) * (y[3] * y[3])) + ((1.4 * 0.001) * V4) * (Tu - y[3])));

	// 0 1 1 0
	Function m09 = Function(y, Return((2.85 * 0.0001) * (y[1] - y[0]) + (2.47 * 0.0001) * (y[3] - y[0]) + (7.36 * 0.00001) * (Tu - y[0]) + (5.78 * 0.0001) * (To - y[0]) + (9.27 * 0.00001) * (Tc - y[0]) + (heat_s * (3.12 * 0.00000000000000001)) * (((3.73 * 1000) * (3.73 * 1000)) * ((3.73 * 1000) * (3.73 * 1000)) - y[0] * (y[0] * (y[0] * y[0]))),
																		(7.60 * 0.00001) * (y[0] - y[1]) + (1.89 * 0.0001) * (y[2] - y[1]) + (7.02 * 0.00001) * (Tu - y[1]) + (6.21 * 0.0001) * (To - y[1]) + (2.42 * 0.0001) * (Tc - y[1]) + (heat_s * (2.55 * 0.0000000000000001)) * (((1.78 * 1000) * (1.78 * 1000)) * ((1.78 * 1000) * (1.78 * 1000)) - (y[1] * y[1]) * (y[1] * y[1])) + ((1.83 * 0.001) * V2) * (Tu - y[1]),
																		1.79 * (0.0001 * (y[1] - y[2])) + 3.81 * (0.0001 * (y[3] - y[2])) + (3.45 * 0.00001) * (Tu - y[2]) + (5.64 * 0.0001) * (To - y[2]) + (3.21 * 0.00000001) * (Tc - y[2]) + (heat_s * (8.57 * 0.0000000000001)) * (((3.82 * 100) * (3.82 * 100)) * ((3.82 * 100) * (3.82 * 100)) - (y[2] * y[2]) * (y[2] * y[2])) + ((3.05 * 0.001) * V3) * (Tu - y[2]),
																		1.09 * (0.0001 * (y[0] - y[3])) + 1.07 * (0.0001 * (y[2] - y[3])) + (3.26 * 0.00001) * (Tu - y[3]) + (5.99 * 0.0001) * (To - y[3]) + (1.73 * 0.0001) * (Tc - y[3]) + (heat_s * (3.57 * 0.00000000000000001)) * (((3.93 * 1000) * (3.93 * 1000)) * ((3.93 * 1000) * (3.93 * 1000)) - (y[3] * y[3]) * (y[3] * y[3]))));

	// 0 1 0 1
	Function m10 = Function(y, Return((2.85 * 0.0001) * (y[1] - y[0]) + (2.47 * 0.0001) * (y[3] - y[0]) + (7.36 * 0.00001) * (Tu - y[0]) + (5.78 * 0.0001) * (To - y[0]) + (9.27 * 0.00001) * (Tc - y[0]) + (heat_s * (3.12 * 0.00000000000000001)) * (((3.73 * 1000) * (3.73 * 1000)) * ((3.73 * 1000) * (3.73 * 1000)) - y[0] * (y[0] * (y[0] * y[0]))),
																		(7.60 * 0.00001) * (y[0] - y[1]) + (1.89 * 0.0001) * (y[2] - y[1]) + (7.02 * 0.00001) * (Tu - y[1]) + (6.21 * 0.0001) * (To - y[1]) + (2.42 * 0.0001) * (Tc - y[1]) + (heat_s * (2.55 * 0.0000000000000001)) * (((1.78 * 1000) * (1.78 * 1000)) * ((1.78 * 1000) * (1.78 * 1000)) - (y[1] * y[1]) * (y[1] * y[1])) + ((1.83 * 0.001) * V2) * (Tu - y[1]),
																		1.79 * (0.0001 * (y[1] - y[2])) + 3.81 * (0.0001 * (y[3] - y[2])) + (3.45 * 0.00001) * (Tu - y[2]) + (5.64 * 0.0001) * (To - y[2]) + (3.21 * 0.00000001) * (Tc - y[2]) + (heat_s * (8.57 * 0.0000000000001)) * (((3.82 * 100) * (3.82 * 100)) * ((3.82 * 100) * (3.82 * 100)) - (y[2] * y[2]) * (y[2] * y[2])),
																		1.09 * (0.0001 * (y[0] - y[3])) + 1.07 * (0.0001 * (y[2] - y[3])) + (3.26 * 0.00001) * (Tu - y[3]) + (5.99 * 0.0001) * (To - y[3]) + (1.73 * 0.0001) * (Tc - y[3]) + (heat_s * (3.57 * 0.00000000000000001)) * (((3.93 * 1000) * (3.93 * 1000)) * ((3.93 * 1000) * (3.93 * 1000)) - (y[3] * y[3]) * (y[3] * y[3])) + ((1.4 * 0.001) * V4) * (Tu - y[3])));

	// 0 0 1 1
	Function m11 = Function(y, Return((2.85 * 0.0001) * (y[1] - y[0]) + (2.47 * 0.0001) * (y[3] - y[0]) + (7.36 * 0.00001) * (Tu - y[0]) + (5.78 * 0.0001) * (To - y[0]) + (9.27 * 0.00001) * (Tc - y[0]) + (heat_s * (3.12 * 0.00000000000000001)) * (((3.73 * 1000) * (3.73 * 1000)) * ((3.73 * 1000) * (3.73 * 1000)) - y[0] * (y[0] * (y[0] * y[0]))),
																		(7.60 * 0.00001) * (y[0] - y[1]) + (1.89 * 0.0001) * (y[2] - y[1]) + (7.02 * 0.00001) * (Tu - y[1]) + (6.21 * 0.0001) * (To - y[1]) + (2.42 * 0.0001) * (Tc - y[1]) + (heat_s * (2.55 * 0.0000000000000001)) * (((1.78 * 1000) * (1.78 * 1000)) * ((1.78 * 1000) * (1.78 * 1000)) - (y[1] * y[1]) * (y[1] * y[1])),
																		1.79 * (0.0001 * (y[1] - y[2])) + 3.81 * (0.0001 * (y[3] - y[2])) + (3.45 * 0.00001) * (Tu - y[2]) + (5.64 * 0.0001) * (To - y[2]) + (3.21 * 0.00000001) * (Tc - y[2]) + (heat_s * (8.57 * 0.0000000000001)) * (((3.82 * 100) * (3.82 * 100)) * ((3.82 * 100) * (3.82 * 100)) - (y[2] * y[2]) * (y[2] * y[2])) + ((3.05 * 0.001) * V3) * (Tu - y[2]),
																		1.09 * (0.0001 * (y[0] - y[3])) + 1.07 * (0.0001 * (y[2] - y[3])) + (3.26 * 0.00001) * (Tu - y[3]) + (5.99 * 0.0001) * (To - y[3]) + (1.73 * 0.0001) * (Tc - y[3]) + (heat_s * (3.57 * 0.00000000000000001)) * (((3.93 * 1000) * (3.93 * 1000)) * ((3.93 * 1000) * (3.93 * 1000)) - (y[3] * y[3]) * (y[3] * y[3])) + ((1.4 * 0.001) * V4) * (Tu - y[3])));

	// 0 1 1 1
	Function m12 = Function(y, Return((2.85 * 0.0001) * (y[1] - y[0]) + (2.47 * 0.0001) * (y[3] - y[0]) + (7.36 * 0.00001) * (Tu - y[0]) + (5.78 * 0.0001) * (To - y[0]) + (9.27 * 0.00001) * (Tc - y[0]) + (heat_s * (3.12 * 0.00000000000000001)) * (((3.73 * 1000) * (3.73 * 1000)) * ((3.73 * 1000) * (3.73 * 1000)) - y[0] * (y[0] * (y[0] * y[0]))),
																		(7.60 * 0.00001) * (y[0] - y[1]) + (1.89 * 0.0001) * (y[2] - y[1]) + (7.02 * 0.00001) * (Tu - y[1]) + (6.21 * 0.0001) * (To - y[1]) + (2.42 * 0.0001) * (Tc - y[1]) + (heat_s * (2.55 * 0.0000000000000001)) * (((1.78 * 1000) * (1.78 * 1000)) * ((1.78 * 1000) * (1.78 * 1000)) - (y[1] * y[1]) * (y[1] * y[1])) + ((1.83 * 0.001) * V2) * (Tu - y[1]),
																		1.79 * (0.0001 * (y[1] - y[2])) + 3.81 * (0.0001 * (y[3] - y[2])) + (3.45 * 0.00001) * (Tu - y[2]) + (5.64 * 0.0001) * (To - y[2]) + (3.21 * 0.00000001) * (Tc - y[2]) + (heat_s * (8.57 * 0.0000000000001)) * (((3.82 * 100) * (3.82 * 100)) * ((3.82 * 100) * (3.82 * 100)) - (y[2] * y[2]) * (y[2] * y[2])) + ((3.05 * 0.001) * V3) * (Tu - y[2]),
																		1.09 * (0.0001 * (y[0] - y[3])) + 1.07 * (0.0001 * (y[2] - y[3])) + (3.26 * 0.00001) * (Tu - y[3]) + (5.99 * 0.0001) * (To - y[3]) + (1.73 * 0.0001) * (Tc - y[3]) + (heat_s * (3.57 * 0.00000000000000001)) * (((3.93 * 1000) * (3.93 * 1000)) * ((3.93 * 1000) * (3.93 * 1000)) - (y[3] * y[3]) * (y[3] * y[3])) + ((1.4 * 0.001) * V4) * (Tu - y[3])));

	// 1 0 1 1
	Function m13 = Function(y, Return((2.85 * 0.0001) * (y[1] - y[0]) + (2.47 * 0.0001) * (y[3] - y[0]) + (7.36 * 0.00001) * (Tu - y[0]) + (5.78 * 0.0001) * (To - y[0]) + (9.27 * 0.00001) * (Tc - y[0]) + (heat_s * (3.12 * 0.00000000000000001)) * (((3.73 * 1000) * (3.73 * 1000)) * ((3.73 * 1000) * (3.73 * 1000)) - y[0] * (y[0] * (y[0] * y[0]))) + ((2.12 * 0.001) * V1) * (Tu - y[0]),
																		(7.60 * 0.00001) * (y[0] - y[1]) + (1.89 * 0.0001) * (y[2] - y[1]) + (7.02 * 0.00001) * (Tu - y[1]) + (6.21 * 0.0001) * (To - y[1]) + (2.42 * 0.0001) * (Tc - y[1]) + (heat_s * (2.55 * 0.0000000000000001)) * (((1.78 * 1000) * (1.78 * 1000)) * ((1.78 * 1000) * (1.78 * 1000)) - (y[1] * y[1]) * (y[1] * y[1])),
																		1.79 * (0.0001 * (y[1] - y[2])) + 3.81 * (0.0001 * (y[3] - y[2])) + (3.45 * 0.00001) * (Tu - y[2]) + (5.64 * 0.0001) * (To - y[2]) + (3.21 * 0.00000001) * (Tc - y[2]) + (heat_s * (8.57 * 0.0000000000001)) * (((3.82 * 100) * (3.82 * 100)) * ((3.82 * 100) * (3.82 * 100)) - (y[2] * y[2]) * (y[2] * y[2])) + ((3.05 * 0.001) * V3) * (Tu - y[2]),
																		1.09 * (0.0001 * (y[0] - y[3])) + 1.07 * (0.0001 * (y[2] - y[3])) + (3.26 * 0.00001) * (Tu - y[3]) + (5.99 * 0.0001) * (To - y[3]) + (1.73 * 0.0001) * (Tc - y[3]) + (heat_s * (3.57 * 0.00000000000000001)) * (((3.93 * 1000) * (3.93 * 1000)) * ((3.93 * 1000) * (3.93 * 1000)) - (y[3] * y[3]) * (y[3] * y[3])) + ((1.4 * 0.001) * V4) * (Tu - y[3])));

	// 1 1 0 1
	Function m14 = Function(y, Return((2.85 * 0.0001) * (y[1] - y[0]) + (2.47 * 0.0001) * (y[3] - y[0]) + (7.36 * 0.00001) * (Tu - y[0]) + (5.78 * 0.0001) * (To - y[0]) + (9.27 * 0.00001) * (Tc - y[0]) + (heat_s * (3.12 * 0.00000000000000001)) * (((3.73 * 1000) * (3.73 * 1000)) * ((3.73 * 1000) * (3.73 * 1000)) - y[0] * (y[0] * (y[0] * y[0]))) + ((2.12 * 0.001) * V1) * (Tu - y[0]),
																		(7.60 * 0.00001) * (y[0] - y[1]) + (1.89 * 0.0001) * (y[2] - y[1]) + (7.02 * 0.00001) * (Tu - y[1]) + (6.21 * 0.0001) * (To - y[1]) + (2.42 * 0.0001) * (Tc - y[1]) + (heat_s * (2.55 * 0.0000000000000001)) * (((1.78 * 1000) * (1.78 * 1000)) * ((1.78 * 1000) * (1.78 * 1000)) - (y[1] * y[1]) * (y[1] * y[1])) + ((1.83 * 0.001) * V2) * (Tu - y[1]),
																		1.79 * (0.0001 * (y[1] - y[2])) + 3.81 * (0.0001 * (y[3] - y[2])) + (3.45 * 0.00001) * (Tu - y[2]) + (5.64 * 0.0001) * (To - y[2]) + (3.21 * 0.00000001) * (Tc - y[2]) + (heat_s * (8.57 * 0.0000000000001)) * (((3.82 * 100) * (3.82 * 100)) * ((3.82 * 100) * (3.82 * 100)) - (y[2] * y[2]) * (y[2] * y[2])),
																		1.09 * (0.0001 * (y[0] - y[3])) + 1.07 * (0.0001 * (y[2] - y[3])) + (3.26 * 0.00001) * (Tu - y[3]) + (5.99 * 0.0001) * (To - y[3]) + (1.73 * 0.0001) * (Tc - y[3]) + (heat_s * (3.57 * 0.00000000000000001)) * (((3.93 * 1000) * (3.93 * 1000)) * ((3.93 * 1000) * (3.93 * 1000)) - (y[3] * y[3]) * (y[3] * y[3])) + ((1.4 * 0.001) * V4) * (Tu - y[3])));

	// 1 1 1 0
	Function m15 = Function(y, Return((2.85 * 0.0001) * (y[1] - y[0]) + (2.47 * 0.0001) * (y[3] - y[0]) + (7.36 * 0.00001) * (Tu - y[0]) + (5.78 * 0.0001) * (To - y[0]) + (9.27 * 0.00001) * (Tc - y[0]) + (heat_s * (3.12 * 0.00000000000000001)) * (((3.73 * 1000) * (3.73 * 1000)) * ((3.73 * 1000) * (3.73 * 1000)) - y[0] * (y[0] * (y[0] * y[0]))) + ((2.12 * 0.001) * V1) * (Tu - y[0]),
																		(7.60 * 0.00001) * (y[0] - y[1]) + (1.89 * 0.0001) * (y[2] - y[1]) + (7.02 * 0.00001) * (Tu - y[1]) + (6.21 * 0.0001) * (To - y[1]) + (2.42 * 0.0001) * (Tc - y[1]) + (heat_s * (2.55 * 0.0000000000000001)) * (((1.78 * 1000) * (1.78 * 1000)) * ((1.78 * 1000) * (1.78 * 1000)) - (y[1] * y[1]) * (y[1] * y[1])) + ((1.83 * 0.001) * V2) * (Tu - y[1]),
																		1.79 * (0.0001 * (y[1] - y[2])) + 3.81 * (0.0001 * (y[3] - y[2])) + (3.45 * 0.00001) * (Tu - y[2]) + (5.64 * 0.0001) * (To - y[2]) + (3.21 * 0.00000001) * (Tc - y[2]) + (heat_s * (8.57 * 0.0000000000001)) * (((3.82 * 100) * (3.82 * 100)) * ((3.82 * 100) * (3.82 * 100)) - (y[2] * y[2]) * (y[2] * y[2])) + ((3.05 * 0.001) * V3) * (Tu - y[2]),
																		1.09 * (0.0001 * (y[0] - y[3])) + 1.07 * (0.0001 * (y[2] - y[3])) + (3.26 * 0.00001) * (Tu - y[3]) + (5.99 * 0.0001) * (To - y[3]) + (1.73 * 0.0001) * (Tc - y[3]) + (heat_s * (3.57 * 0.00000000000000001)) * (((3.93 * 1000) * (3.93 * 1000)) * ((3.93 * 1000) * (3.93 * 1000)) - (y[3] * y[3]) * (y[3] * y[3]))));

	// 1 1 1 1
	Function m16 = Function(y, Return((2.85 * 0.0001) * (y[1] - y[0]) + (2.47 * 0.0001) * (y[3] - y[0]) + (7.36 * 0.00001) * (Tu - y[0]) + (5.78 * 0.0001) * (To - y[0]) + (9.27 * 0.00001) * (Tc - y[0]) + (heat_s * (3.12 * 0.00000000000000001)) * (((3.73 * 1000) * (3.73 * 1000)) * ((3.73 * 1000) * (3.73 * 1000)) - y[0] * (y[0] * (y[0] * y[0]))) + ((2.12 * 0.001) * V1) * (Tu - y[0]),
																		(7.60 * 0.00001) * (y[0] - y[1]) + (1.89 * 0.0001) * (y[2] - y[1]) + (7.02 * 0.00001) * (Tu - y[1]) + (6.21 * 0.0001) * (To - y[1]) + (2.42 * 0.0001) * (Tc - y[1]) + (heat_s * (2.55 * 0.0000000000000001)) * (((1.78 * 1000) * (1.78 * 1000)) * ((1.78 * 1000) * (1.78 * 1000)) - (y[1] * y[1]) * (y[1] * y[1])) + ((1.83 * 0.001) * V2) * (Tu - y[1]),
																		1.79 * (0.0001 * (y[1] - y[2])) + 3.81 * (0.0001 * (y[3] - y[2])) + (3.45 * 0.00001) * (Tu - y[2]) + (5.64 * 0.0001) * (To - y[2]) + (3.21 * 0.00000001) * (Tc - y[2]) + (heat_s * (8.57 * 0.0000000000001)) * (((3.82 * 100) * (3.82 * 100)) * ((3.82 * 100) * (3.82 * 100)) - (y[2] * y[2]) * (y[2] * y[2])) + ((3.05 * 0.001) * V3) * (Tu - y[2]),
																		1.09 * (0.0001 * (y[0] - y[3])) + 1.07 * (0.0001 * (y[2] - y[3])) + (3.26 * 0.00001) * (Tu - y[3]) + (5.99 * 0.0001) * (To - y[3]) + (1.73 * 0.0001) * (Tc - y[3]) + (heat_s * (3.57 * 0.00000000000000001)) * (((3.93 * 1000) * (3.93 * 1000)) * ((3.93 * 1000) * (3.93 * 1000)) - (y[3] * y[3]) * (y[3] * y[3])) + ((1.4 * 0.001) * V4) * (Tu - y[3])));

	sampledSwitchedSystem sys;

	sys.period = 25;
	sys.dynamics.push_back(&m01);
	sys.dynamics.push_back(&m02);
	sys.dynamics.push_back(&m03);
	sys.dynamics.push_back(&m04);
	sys.dynamics.push_back(&m05);
	sys.dynamics.push_back(&m06);
	sys.dynamics.push_back(&m07);
	sys.dynamics.push_back(&m08);
	sys.dynamics.push_back(&m09);
	sys.dynamics.push_back(&m10);
	sys.dynamics.push_back(&m11);
	sys.dynamics.push_back(&m12);
	sys.dynamics.push_back(&m13);
	sys.dynamics.push_back(&m14);
	sys.dynamics.push_back(&m15);
	sys.dynamics.push_back(&m16);

	sys.nb_dynamics = 16;

	IntervalVector R(4); // Objectif
	
	R[0] = Interval(20, 22);
	R[1] = Interval(20, 22);
	R[2] = Interval(20, 22);
	R[3] = Interval(20, 22);

#ifdef DECOMPOSE

	IntervalVector W(4); // ensemble de depart
	W[0] = Interval(20, 22);
	W[1] = Interval(20, 22);
	W[2] = Interval(20, 22);
	W[3] = Interval(20, 22);

	IntervalVector B(4); // zone interdite
	B[0] = Interval(0.0, 1.0);
	B[1] = Interval(0.0, 1.0);
	B[2] = Interval(0.0, 1.0);
	B[3] = Interval(0.0, 1.0);

	IntervalVector S(4);
	S[0] = Interval(19, 23);
	S[1] = Interval(19, 23);
	S[2] = Interval(19, 23);
	S[3] = Interval(19, 23);

	std::list<IntervalVector> list_W;
	list_W.push_back(W);

	//file for solutions
	std::ofstream file("./result_4_rooms.txt", std::ios::out | std::ios::trunc);

	while (!list_W.empty())
	{
		IntervalVector current_W = list_W.front();
		list_W.pop_front();

		if (current_W.diam().max() > 0.6)
		{
			LargestFirst bbb(0.1, 0.5);
			std::pair<IntervalVector, IntervalVector> p = bbb.bisect(current_W);
			list_W.push_back(p.first);
			list_W.push_back(p.second);
			continue;
		}

		std::cout << "taille list_W : " << list_W.size() << std::endl;

		std::vector<std::pair<IntervalVector, std::vector<int> > > result;
		unsigned int k = NB_K;
		unsigned int d = NB_D;

		bool flag = LUtils::decompose(sys, current_W, R, B, S, k, d, result);

		if (result.empty())
		{
			std::cerr << "No solution with k = " << k << " and d = " << d << std::endl;
			file << current_W << " : no sol" << std::endl;
		}
		else
		{
			if (flag)
			{
				std::cerr << "Complete result -> PROOF" << std::endl;
			}
			else
			{
				std::cerr << "Incomplete result" << std::endl;
			}

			// Display result
			std::vector<std::pair<IntervalVector, std::vector<int> > >::const_iterator it = result.begin();
			for (; it != result.end(); it++)
			{
				file << "zon = str2zon2(\"";
				file << it->first << "\"); \n if is_in_zonotope(X,zon) \t \n pattern = [";

				std::vector<int>::const_iterator it_pat = (it->second).begin();
				for (; it_pat != (it->second).end(); it_pat++)
				{
					file << *it_pat << " ";
				}
				file << "]; \n endif" << std::endl;
			}
		}
	}
	file.close();

#endif
	return 0;
}

